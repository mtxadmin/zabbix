<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2023-08-09T16:00:00Z</date>
    <groups>
        <group>
            <name>MS SQL Servers</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template DB MSSQL</template>
            <name>Template DB MSSQL</name>
            <description>Additional template for Microsoft SQL servers. Items, triggers, etc. Including backup events and errors.</description>
            <groups>
                <group>
                    <name>MS SQL Servers</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>MS SQL</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>SQL: Error events - availability group</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,&quot;availability group&quot;,&quot;Critical|Error|Warning&quot;,&quot;^(MSSQLSERVER|SQLSERVERAGENT|SQLAgent.*)$&quot;,,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>All sql errors but about availability group syncs</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Error events</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,&quot;^((?!availability group).)*$&quot;,&quot;Critical|Error|Warning&quot;,&quot;^(MSSQLSERVER|SQLSERVERAGENT|SQLAgent.*|MSDPM|FailoverClustering)$&quot;,,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>All sql errors but about availability group syncs</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(BACKUP failed,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Backup error events</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{regexp(,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Error events</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Backup errors events 2</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Error&quot;,&quot;SQLISPackage[0-9]+&quot;,12291,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Backup error events (from jobs)</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <description>SQL 2017 - SQLISPackage140</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Backup information events v2 1</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Information&quot;,&quot;SQLISPackage[0-9]+&quot;,&quot;12288|12289&quot;,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>EventID 12288 - Job started&#13;
EventID 12289 - Job successfully finished</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(finished successfully,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Backup informational events from jobs - finished</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>SQL 2017 - SQLISPackage140</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Backup information events v2 2.1</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Information&quot;,&quot;SQLSERVERAGENT&quot;,208,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(The Job was invoked by User,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Backup informational events from jobs - manually started</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Backup information events v1</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Information&quot;,MSSQLSERVER,3014,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <description>EventID 3014 - BACKUP DATABASE successfully processed</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(BACKUP DATABASE successfully processed [1-9].*)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Backup informational events</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <status>DISABLED</status>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Backup information events v2 2.2</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Application,,&quot;Warning&quot;,&quot;SQLSERVERAGENT&quot;,208,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Cluster error events 2</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[Microsoft-Windows-FailoverClustering/Operational,,&quot;Critical|Errors&quot;,,,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Cluster error events 2</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Cluster error events 1</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>eventlog[System,,&quot;Critical|Errors&quot;,FailoverClustering,,,skip]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{regexp(,5m)}&lt;&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{nodata(5m)}=1</recovery_expression>
                            <name>MSSQL: Cluster error events 1</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: % Processor Time</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Process(sqlservr)\% Processor Time&quot;]</key>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: RAM Private Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Process(sqlservr)\Private Bytes&quot;]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: RAM Working Set</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[&quot;\Process(sqlservr)\Working Set&quot;]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Page Reads/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[\Memory\Page Reads/sec]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Page writes/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[\SQLServer:Buffer Manager\Page writes/sec]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Log Bytes Flushed/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[\SQLServer:Databases(_Total)\Log Bytes Flushed/sec]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Batch Requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[\SQLServer:SQL Statistics\Batch Requests/sec]</key>
                    <delay>5m</delay>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Compilations/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[\SQLServer:SQL Statistics\SQL Compilations/sec]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Re-Compilations/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>perf_counter[\SQLServer:SQL Statistics\SQL Re-Compilations/sec]</key>
                    <delay>10m</delay>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Service State - SQL Server</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service_state[MSSQLSERVER]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Service State - SQL Agent</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service_state[SQLServerAgent]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Blocked Processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[BlockedProcesses.sql]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(#3)}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#3)}&lt;1</recovery_expression>
                            <name>MSSQL: Blocked processes more than 0</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>More at &#13;
https://dba.stackexchange.com/questions/165143/how-to-get-the-sql-server-activity-monitors-output-using-t-sql&#13;
and&#13;
https://stackoverflow.com/questions/37296185/sql-query-to-list-head-blockers</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Blocks</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[Blocks.sql]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: CheckpointStall</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[CheckpointStall.sql]</key>
                    <delay>10m</delay>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Head Blocker info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[HeadBlocker.sql]</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>String info about Head Blocker process&#13;
&#13;
It was not tested yet</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>NOT_MATCHES_REGEX</type>
                            <params>/^$/</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;&quot;&quot;</expression>
                            <name>MSSQL: Head Blocker info</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>More at &#13;
https://dba.stackexchange.com/questions/165143/how-to-get-the-sql-server-activity-monitors-output-using-t-sql&#13;
and&#13;
https://stackoverflow.com/questions/37296185/sql-query-to-list-head-blockers</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: HeadBlocker num</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[HeadBlockerNum.sql]</key>
                    <status>DISABLED</status>
                    <description>it should be head blocker num, but in fact it shows ordinary blocks.</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#3)}&lt;1</recovery_expression>
                            <name>MSSQL: Head Blocker num</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <status>DISABLED</status>
                            <priority>HIGH</priority>
                            <description>More at &#13;
https://dba.stackexchange.com/questions/165143/how-to-get-the-sql-server-activity-monitors-output-using-t-sql&#13;
and&#13;
https://stackoverflow.com/questions/37296185/sql-query-to-list-head-blockers</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: HeadBlocker4 num</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[HeadBlockerNum_4.sql]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(#3)}&lt;1</recovery_expression>
                            <name>MSSQL: Head Blocker num v4</name>
                            <opdata>{ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <description>More at &#13;
https://dba.stackexchange.com/questions/165143/how-to-get-the-sql-server-activity-monitors-output-using-t-sql&#13;
and&#13;
https://stackoverflow.com/questions/37296185/sql-query-to-list-head-blockers</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL: Head Blocker_2 info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[HeadBlocker_2.sql]</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>String info about Head Blocker process&#13;
&#13;
It was not tested yet</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>NOT_MATCHES_REGEX</type>
                            <params>/^$/</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>SQL: Head Blocker_4 info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[HeadBlocker_4.sql]</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>String info about Head Blocker process&#13;
&#13;
It was not tested yet</description>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>NOT_MATCHES_REGEX</type>
                            <params>/^$/</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>SQL Logins</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[Logins.sql]</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Low Memory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[LowMemory.sql]</key>
                    <delay>10m</delay>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: N of memory dumps on server</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[MemoryDumps.sql]</key>
                    <delay>10m</delay>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: PageLifeExpectancy</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[PageLifeExpectancy.sql]</key>
                    <delay>10m</delay>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: ProcessesBlocked</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[ProcessesBlocked.sql]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: SQLMemory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[SQLMemory.sql]</key>
                    <delay>10m</delay>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: N of suspect pages</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[SuspectPages.sql]</key>
                    <delay>10m</delay>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: SuspendedRequests</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[SuspendedRequests.sql]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SQL: Waiting Tasks</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>sql.script[WaitingTasks.sql]</key>
                    <applications>
                        <application>
                            <name>MS SQL</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(#2)}&gt;=150</expression>
                            <name>MSSQL: SQL waiting tasks more than 150</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>MSSQL: SQL waiting tasks more than 500</name>
                                    <expression>{Template DB MSSQL:sql.script[WaitingTasks.sql].min(#3)}&gt;=500</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                        <trigger>
                            <expression>{min(#3)}&gt;=500</expression>
                            <name>MSSQL: SQL waiting tasks more than 500</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SQL Logins json</name>
                    <type>DEPENDENT</type>
                    <key>sql_logins_json</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <preprocessing>
                        <step>
                            <type>CSV_TO_JSON</type>
                            <params> 

0</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>sql.script[Logins.sql]</key>
                    </master_item>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>SQL Logins</name>
                    <type>DEPENDENT</type>
                    <key>sql_logins_discovery</key>
                    <delay>0</delay>
                    <master_item>
                        <key>sql_logins_json</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.2</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#SERVER}</lld_macro>
                            <path>$.1</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$MEMORY.UTIL.MAX}</macro>
                    <value>97</value>
                    <description>Macro for memory override for SQL servers - they are typically filled RAM with data, this is pretty normal.</description>
                </macro>
            </macros>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{Template DB MSSQL:eventlog[Application,,&quot;Warning&quot;,&quot;SQLSERVERAGENT&quot;,208,,skip].regexp(Backup job failed,5m)}&lt;&gt;0</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template DB MSSQL:eventlog[Application,,&quot;Information&quot;,&quot;SQLSERVERAGENT&quot;,208,,skip].nodata(5m)}=1</recovery_expression>
            <name>MSSQL: Backup informational events from jobs - failed</name>
            <priority>HIGH</priority>
        </trigger>
        <trigger>
            <expression>{Template DB MSSQL:eventlog[Application,&quot;availability group&quot;,&quot;Critical|Error|Warning&quot;,&quot;^(MSSQLSERVER|SQLSERVERAGENT|SQLAgent.*)$&quot;,,,skip].regexp(,5m)}&lt;&gt;0</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template DB MSSQL:eventlog[Application,&quot;^((?!availability group).)*$&quot;,&quot;Critical|Error|Warning&quot;,&quot;^(MSSQLSERVER|SQLSERVERAGENT|SQLAgent.*|MSDPM|FailoverClustering)$&quot;,,,skip].nodata(5m)}=1</recovery_expression>
            <name>MSSQL: Error events - availability group</name>
            <opdata>{ITEM.LASTVALUE1}</opdata>
            <priority>HIGH</priority>
            <manual_close>YES</manual_close>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>SQL: % Processor Time</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template DB MSSQL</host>
                        <key>perf_counter[&quot;\Process(sqlservr)\% Processor Time&quot;]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>SQL: Batch Requests/sec</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template DB MSSQL</host>
                        <key>perf_counter[\SQLServer:SQL Statistics\Batch Requests/sec]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>SQL: Compilations/sec</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template DB MSSQL</host>
                        <key>perf_counter[\SQLServer:SQL Statistics\SQL Compilations/sec]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
